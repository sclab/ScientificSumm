One extra field is required in each node, as follows: x.j - down count The value of x.j is initially set to zero in all nodes and is incremented each time Down is called with x as its argument.
Furthermore, the same weight is used regardless of the number of times an element is contained in a reported element.
When computing the score of node , the value of x.j selects 1 Up ( x , y ) ≡ 2 if not y.reported then 3 S.remove ( y ) 4 y.g ← y.g + x.f − x.g 5 recompute y.score 6 