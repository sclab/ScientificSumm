For each node, GetBoundaries() in line 5 searches for the  predecessor and successor anchors in the sequence so as to  determine the boundaries of this node.
Because the exact locations of all the anchors in a node sequence are known, all the nodes in this sequence can be divided into O(M +1) parts in the area.
Then in line 6 UpdateMap() shrinks the location area of this node according to the newly obtained boundaries.
1 : repeat 2 : GetOneUnprocessedSeqence ( ) ; 3 : repeat 4 : GetOneNodeFromSequenceInOrder ( ) ; 5 : GetBoundaries ( ) ; 6 