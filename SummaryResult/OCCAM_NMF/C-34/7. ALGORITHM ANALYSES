60 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 0.09 0.1 0.11 0 1000 2000 3000 4000 5000 6000 7000 8000 9000 10000 fraction of compromised bivariate polynomials sensornodeswithatleastonecompromisedpolynomialshare h(9,3,2,34,2) h(16,4,2,25,2) h(225,15,2,7,2) h(1296,36,2,3,2) h(2,14) figure.7 the comparison between pc and the number of sensor nodes with at least one compromised polynomial share in sensor networks based on h(9,3,2,2,n) and h(2,p) distribution models. 
from figure.7, it is easy to know that the conclusion of theorem 9 is correct, and the number of the affected sensor nodes in the sensor network increases with the increasing of the number of compromised nodes, when the scale of the sensor network is fixed.
since u>v ⇒ x>m ⇒ pc ××n (m+n)< pc ××n (x+n)= pc ××n p. supposing that the scale of the sensor network is n=10000, figure.7 presents the comparison between pc and the number of sensor nodes with at least one compromised polynomial share in sensor networks based on h(9,3,2,2,n) and h(2,p) distribution models.
proof: since the number of affected nodes of the h(k,u,m,v,n) model based key predistribution scheme is pc ××n (m+n), and it is proved in [7] that the number of affected nodes of the h(v,p) model based key predistribution scheme is pc ××n p. let p=x+n, then there is um * vn = vx * vn ⇒ um =vx .
theorem 6: supposing that the total sensors is n in the sensor network, and the fraction of compromised nodes is pc, then when u>v, the number of affected nodes of the h(v,p) model based key predistribution scheme, is bigger than that of the h(k,u,m,v,n) model based key predistribution scheme.
0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0 1000 2000 3000 4000 5000 6000 7000 8000 f rac tion of c om prom is ed b ivariate p oly nom ialssensornodeswithatleastonecompromisedpolynomialshare h (1,0,0,100,2) h (2,2,1,71,2) h (4,2,2,50,2) h (8,2,3,36,2) figure.6 the comparison between pc and the number of sensor nodes with at least one compromised polynomial share in sensor networks based on different h(k,u,m,v,n) distribution models.
from figure.6, it is easy to know that, when the scale of the sensor network is fixed, the number of the affected sensor nodes in the sensor network increases with the increasing of the number of compromised nodes.
supposing that the scale of the sensor network is n=10000, figure.6 presents the comparison between pc and the number of sensor nodes with at least one compromised polynomial share in sensor networks based on different h(k,u,m,v,n) distribution models.
and they may need to re-establish a new indirect pairwise key between them by select alternative intermediate nodes that do not belong to the n" compromised nodes.
however, the indirect pairwise keys in the remaining n- n" sensor nodes may be affected.
so, the remaining n- n" sensor nodes can establish direct pairwise key by using any one of their polynomial shares.
among all of the remaining n- n" sensor nodes, none of them includes a compromised polynomial share.
assume the fraction of the compromised polynomials is pc, then there are up to n"=pc × { vn v n umv n n mn ××+×× ][ }= pc ××n (m+n) sensor nodes that have at least one compromised polynomial share.
attacks against the sensor network supposing that the attackers know the distribution of the polynomials over sensor nodes, it may systematically attack the network by compromising the polynomials in f one by one in order to compromise the entire network.
therefore, the intruders need to compromise (m+n)(t+1) sensor nodes altogether to prevent u,v to establish the pairwise key.
then, the intruders need to compromise all of the m+n bivariate polynomials of node u or v. since the degree of the bivariate polynomial f(x,y) is t, so for bivariate polynomial, the intruders need to compromise at least t+1 sensor nodes that have a share of the given bivariate polynomial.
2. supposing that the intruders want to attack two particular sensor nodes u,v, where u,v are all not compromised nodes, but the intruders want to prevent them to establish the pairwise key.
but even if the intruders succeed to do that, node u and v can still  reestablish indirect pairwise key through alternative intermediate nodes.
2) if u,v can establish indirect pairwise key through intermediate nodes, then the intruders need to compromise at least one intermediate node, or compromise the common bivariate polynomial f(x,y) between two neighboring intermediate nodes.
since the degree of the bivariate polynomial f(x,y) is t, so the intruders need to compromise at least t+1 sensor nodes that have a share of the bivariate polynomial f(x,y).
1) if u,v can establish direct pairwise key, then the only way to compromise the key is to compromise the common bivariate polynomial f(x,y) between u,v.
attacks against a pair of sensor nodes 1. supposing that the intruders want to attack two particular sensor nodes u,v, where u,v are all not compromised nodes, but the intruders want to compromise the pairwise key between them.
2) the attackers may attack against the whole sensor network, inorder to decrease the probability of the pairwise key establishment, or increase the cost of the pairwise key establishment.
59 7.2 security analyses by using the pairwise key establishment algorithm based on the h(k,u,m,v,n) model, the intruders can launch two kinds of attacks: 1) the attackers may target the pairwise key between two particular sensor node, in order to compromise the pairwise key between them, or prevent them to establish pairwise key.
according to the former anayses in this paper and the definition of the pairwise key distribution scheme based on the hypercube model h(v,p) in [7], it is easy to know that the conclusion of the theorem stands.
then obviously, the h(k,u,m,v,n) model will degrade into the h(v,n) model.
proof: as for the pairwise key distribution scheme based on the h(k,u,m,v,n) model, let k=1 (u=1, m=0), which means that the total sensor network includes only one cluster.
theorem 5: supposing that the total sensors is n in the sensor network, then the pairwise key distribution scheme based on the hypercube model h(v,p), is only a special case of the pairwise key distribution scheme based on the h(k,u,m,v,n) model.
from figure.5, it is easy to know that the theorem 5 stands.
1 2 3 4 5 6 7 8 9 10 0 0.5 1 1.5 x 10 -3 scaleofthesensornetwork probabilitytoestablishdirectkey h(k,u,m,v,n)model-based h(v,p)model-based figure.5 comparison between the probability of direct pairwise key establishment between h(v,n) and h(k,u,m,v,n) models.
supposing that the total number of nodes in the sensor network is n, figure.5 illustrates the comparison between the probability of direct pairwise key establishment between any two nodes based on the h(k,u,m,v,n) model and the probability of direct pairwise key establishment between any two nodes based on the h(v,p) model, when u=4 and v=2.
supposing that the total number of nodes in the sensor network is n=214 , and h(k,u,m,v,n)=h(16,4,2,2,10), h(v,p)= h(10,14), then the probability of direct pairwise key establishment between any two nodes based on the h(k,u,m,v,n) model is p=  (m(u-1)+n(v1))/(n-1)= (2(4-1)+10(2-1))/(214 -1)=16/(214 -1), but the probability of direct pairwise key establishment between any two nodes based on the h(v,p) model is p"= p(v-1)/(n-1)=14(2-1)/(214 -1)= 14/(214  1).
as for the conclusion of theorem 4, we give an example to illustrate.
therefore, the conclusion of the theorem stands.
so, there is f(t) ≥ 0 ⇒ vt -1 ≥ t(v-1) ⇒ m(vt -1) ≥ tm(v-1) ⇒  m(u1) ≥ x(v-1).
construct a function as f(t)= vt -1- t(v-1), where t ≥ 2. when t=2, it is obvious that there is f(t)= vt -2v+1=( v-1)2 ≥ 0 and f"(t)=t vt-1 - v+1 ≥ 2v- v+1= v+1>0.
next, we will prove that m(u-1) ≥ x(v-1): m(u-1)= m(vt -1), x(v-1)= tm(v-1).
according to the description in [7], it is well know that the probability of direct pairwise key establishment between any two nodes can be estimated as p"= p(v-1)/(n-1)= (x(v-1)+n(v-1))/(n-1).
from the property 3, it is easy to know that the probability of direct pairwise key establishment between any two nodes can be estimated as p=(m(u-1)+n(v-1))/(n-1).
let p=x+n, then there is um *vn = vx * vn ⇒ um =vx ⇒ x=tm.
proof: since u ≥ v, then we can let u=vt , where t ≥ 2. since the total number of nodes in h(v,p) is vp =n, the total number of nodes in h(k,u,m,v,n) is um * vn =n.
theorem 4: supposing that the total sensors is n in the sensor network, then when u ≥ v2 , the probability of direct pairwise key establishment between any two nodes, when using the key distribution scheme based on the hypercube model h(v,p), is smaller than that when using the key distribution scheme based on the h(k,u,m,v,n) model.
from figure.4, it is easy to know that by using new pairwise key predistribution scheme based on h(k,u,m,v,n) model, the probability of direct pairwise key establishment between any two nodes decreases with the increasing of the scale of the sensor networks, and in addition, the probability of direct pairwise key establishment between any two nodes decreases with the increasing of the dimension n, when the scale of the sensor network is fixed.
2 3 4 5 6 7 8 9 10 0 0.002 0.004 0.006 0.008 0.01 number of dimension probabilitytoestablishdirectkey n = 8000 n=10000 n=20000 n=30000 figure.4 comparision between the probability of direct pairwise key establishment between any two nodes and the dimension n, when the sensor network has different total nodes, and use the new pairwise key predistribution scheme based on h(8,2,3,v,n) model.
figure.4 presents the comparision between the probability of direct pairwise key establishment between any two nodes and the dimension n, when the sensor network has different total nodes, and use the new pairwise key predistribution scheme based on h(8,2,3,v,n) model.
obviously, in the logical hypercube formed by the nodes in the same cluster of node a, there are n(v-1) nodes, which 58 have direct pairwise key with node a. and in the logical hypercube formed by the nodes in different clusters from that of node a, there are m(u-1) nodes, which have direct pairwise key with node a. therefore, there are totally m(u-1)+n(v-1) nodes, which have direct pairwise key with node a. so, the probability of pairwise key establishment between any two nodes can be estimated as p=(m(u-1)+n(v-1))/(n-1), since the whole sensor network has n sensor nodes in all.
proof: since the predistributed pairwise keys for any node fa ={ f iiil n 1 ,...,,, 32 >< (i1,y),…, f n iiil n >< −121 ,...,,, (in,y); f jjinii m 1 ,...,,,...,2,1 2 >< (j1 ,y),…, f m jjinii m >< −11 ,...,,,...,2,1 ( jm,y) } in the newly proposed algorithm.
7.1 practical analyses according to the former description and analyses, it is easy to know that the above newly proposed algorithm has the following properties: property 3: when there exist no fault and compromised nodes, by using new pairwise key predistribution scheme based on h(k,u,m,v,n) model, the probability of direct pairwise key establishment between any two nodes can be estimated as p=(m(u-1)+n(v-1))/(n-1), where n is the total number of nodes in the sensor network, and n=um * vn .
