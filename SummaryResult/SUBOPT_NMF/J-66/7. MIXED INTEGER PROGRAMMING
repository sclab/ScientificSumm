If the final (infinite) segment starts at (sk, tk) and has slope d, we add the constraint that ui j ≤ tk + d(πci − sk).
Using the fact that the function is concave, for each value of πci , the tightest upper bound on ui j is the one corresponding to the segment above that value of πci , and therefore these constraints are sufficient to force the correct value of ui j.
For 0 ≤ l ≤ k + 1, let λi,j l be the weight on si,j l .
Now we add the constraint πci = k+1 l=0 si 