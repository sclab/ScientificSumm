Q : = indices of Wsorted for k = 1 to |Q| if Q ( k ) ≤ i or D ( Q ( k ) ) ≥ Dmax //slot is already passed continue if R ( Q ( k ) , Dmax − D ( Q ( k ) ) ) < X D ( Q ( k ) ) = Dmax X = X − R ( j , Dmax − D ( Q ( k ) ) ) else //X insufficient to increase duty cycle to Dmax if P ( Q ( k ) ) > Pl 