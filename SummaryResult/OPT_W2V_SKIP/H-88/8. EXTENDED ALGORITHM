The Down  routine does not report its argument, but instead recomputes its score and adds it back into S. A node cannot be an argument to Down more than M +1 times, which in turn implies an overall time complexity of O((nM + mh) log n).
Furthermore, the same weight is used regardless of the number of times an element is contained in a reported element.
When computing the score of node , the value of x.j selects 1 Up ( x , y ) ≡ 2 if not y.reported then 3 S.remove ( y ) 4 y.g ← 