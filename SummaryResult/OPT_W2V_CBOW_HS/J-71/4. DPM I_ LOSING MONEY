E[P1|A] is the trader"s expectation of the payoff per share of A after the market closes and given that A occurs.
Finally, note that the above price function is undefined when the amount bet or the number of shares are zero.
If one uses the above price function, then the market dynamics will be such that the ratio of the  (instantaneous) prices of A and B always equals the ratio of the amounts wagered on A and B, which seems fairly natural.
4.2.1 Price function I: Price of A equals payoff of B One natural price function to consider is to set the price per share of A equal to the payoff per share of B, and set the price per share of B equal to the payoff per share of A.
If E[ shares]/ > 0, a risk-neutral trader should purchase shares of A.
Assuming  riskneutrality, the trader"s optimization problem is to choose a number of shares n ≥ 0 of A to purchase, in order to  maximize E[n shares] = Pr(A)·n·E [P1|A]−(1−Pr(A))· Z n 0 p1(n)dn.
So, if A occurs, shareholders of A receive all of their  initial payment back, plus P1 dollars per share owned, while shareholders of B lose all money wagered.
Let n be the number of shares purchased and let m be the amount of money spent purchasing n shares.
This could be generalized so that the market institution always takes a certain amount, or a certain percent, or a certain amount per transaction, or a certain percent per transaction, before money in returned or redistributed.
The constraints (4) lead to the following derivation of the market probability: MPr(A)P1 = MPr(B)p1 MPr(A)P1 = MPr(B)P2 MPr(A) MPr(B) = P2 P1 MPr(A) MPr(B) = M1 N2 M2 N1 MPr(A) MPr(B) = M1N1 M2N2 MPr(A) = M1N1 M1N1 + M2N2 (5) The constraints (4) specify the instantaneous  relationship between payoff and price.
The trader"s per-share expected value for purchasing an infinitesimal quantity of shares of A is E[ shares] = Pr(A) · E [P1|A] − (1 − Pr(A)) · p1 E[ shares] = Pr(A) · E » M2 N1 ˛ ˛ ˛ ˛ A  − (1 − Pr(A)) · p1 where is an infinitesimal quantity of shares of A, Pr(A) is the trader"s belief in the probability of A, and p1 is the instantaneous price per share of A for an infinitesimal  quantity of shares.
For example, the  market institution can place an ask order for 100 shares at price m(100)/100, another ask order for 100 shares at price (m(200)−m(100))/100, a third ask for 100 shares at (m(300)− m(200))/100, etc.
Using Equation 8, along with (2) and (3), we can derive the implied market probability: M1 M2 = p1 p2 = MPr(A) MPr(B) · M2 N1 MPr(B) MPr(A) · M1 N2 = (MPr(A))2 (MPr(B))2 · M2N2 M1N1 (MPr(A))2 (MPr(B))2 = (M1)2 N1 (M2)2N2 MPr(A) MPr(B) = M1 √ N1 M2 √ N2 MPr(A) = M1 √ N1 M1 √ N1 + M2 √ N2 (9) We can solve for the instantaneous price as follows: p1 = MPr(A) MPr(B) · P1 = M1 √ N1 M2 √ N2 · M2 N1 = M1 √ N1N2 (10) Working from the above instantaneous price, we can  derive the implied cost function m as a function of the number n of shares purchased as follows: dm dn = M1 + m √ N1 + n √ N2 Z dm M1 + m = Z dn √ N1 + n √ N2 ln(M1 + m) = 2 N2 [(N1 + n)N2] 1 2 + C m = M1 " e 2 r N1+n N2 −2 r N1 N2 − 1 # .
That is, find n ≥ 0 satisfying 0 = Pr(A) · E [P1|A] − (1 − Pr(A)) · p1(n), if such a n exists, otherwise n = 0.
Substituting into equation (4), we get: p1 = P2 dm dn = M1 + m N2 dm M1 + m = dn N2 Z dm M1 + m = Z dn N2 ln(M1 + m) = n N2 + C m = M1 h e n N2 − 1 i (6) Equation 6 gives the cost of purchasing n shares.
So, in order to  determine the expected value of shares of A, the trader must estimate what he or she expects the payoff per share to be in the end (after the market closes) if A occurs.
From this, we can derive how prices change when (non-infinitesimal) shares are  purchased.
This seems like a particularly natural way to set the price, since the more money that is wagered on one side, the cheaper becomes a share on the other side, in exactly the same proportion.
In general, p1 increases as more shares are purchased.
REDISTRIBUTED For the case where the initial payments on winning bets are refunded, and only losing money is redistributed, the respective payoffs per share are simply: P1 = M2 N1 P2 = M1 N2 .
Note that p1 = dm/dn, the instantaneous price per share, and m = R n 0 p1(n)dn.
The initialization amounts could be funded as a subsidy from the market institution or a patron, which I"ll call a seed wager, or from a portion of the fees charged, which I"ll call an ante wager.
(3) That is, we assume that the current value for the payoff per share of A is the same as the expected final value of the  payoff per share of A given that A occurs.
Assuming an efficient marketplace, the market as a whole  considers E[ shares]/ = 0, since the mechanisms is a zero sum game.
4.2.2 Price function II: Price of A proportional to money on A A second price function can be derived by requiring the ratio of prices to be equal to the ratio of money wagered.
The risk-neutral trader should  continue purchasing shares until E[ shares]/ = 0.
Similarly, if B occurs, shareholders of B receive all of their initial payment back, plus P2 dollars per share owned, while shareholders of A lose all money wagered.
4.1 Market probability As traders who believe that E[ shares of A]/ > 0  purchase shares of A and traders who believe that E[ shares of B]/ > 0 purchase shares of B, the prices p1 and p2 change according to a price function, as prescribed below.
The notion of buying infinitesimal shares, or  integrating costs over a continuous function, are probably foreign to most traders.
The  instantaneous price per share as a function of n is p1(n) = dm dn = M1 N2 e n N2 .
If traders can assume that (3) is true, then their optimization  problem (1) is greatly simplified; however, optimizing (1) does not depend on the assumption, and traders can still optimize by strategically projecting the final expected payoff in  whatever complicated way they desire.
This depends on the price function determining p1.
(8) In other words, the price of A is proportional to the amount of money wagered on A, and similarly for B.
The value of P1 does not matter if B occurs, since in this case shares of A are  worthless, and the current value of P1 does not necessarily matter as this may change as trading continues.
A trader buying less than 100 shares would pay a bit more than if the true cost were computed using (6), but the discretized interface would probably be more intuitive and transparent to the majority of traders.
The  relationship makes sense, since new information supporting A should encourage purchasing of shares A, driving up both the price of A and the payoff of B, and driving down the price of B and the payoff of A.
Without loss of generality, I will analyze the market from the perspective of A, deriving prices and payoffs for A only.
The derivation of the price function p2(n) for B is analogous and the results are symmetric.
For example, if market participants in aggregate felt that E[ shares]/ > 0, then there would be net demand for A, driving up the price of A until E[ shares]/ = 0.
This is certainly true for the last (infinitesimal) wager before the market closes.
In this setting, assumption (3) seems especially reasonable, since if an efficient market hypothesis leads prices to follow a random walk, than payoffs must also follow a random walk.
(1) It"s easy to see that the same value of n can be solved for by finding the number of shares required to drive E[ shares]/ to zero.
(A  riskaverse trader will generally stop purchasing shares before driving E[ shares]/ all the way to zero.)
Basically, we are assuming that the value of P1 moves according to an unbiased random walk: the current value of P1 is the best expectation of its future value.
The above equations assume that all money that comes in is eventually returned or redistributed.
(11) From this we get the price function: p1(n) = dm dn = M1 p (N1 + n)N2 e 2 r N1+n N2 −2 r N1 N2 .
I conjecture that there are reasonable  market efficiency conditions under which assumption (3) is true, though I have not been able to prove that it arises naturally from rational trading.
The current prices in a sense reflect the market"s opinion as a whole of the relative probabilities of A and B.
Solving we get MPr(A) = p1 p1 + E[P1|A] .
Define MPr(A) to be the market probability of A, or the  probability of A inferred by assuming that E[ shares]/ = 0.
This is a subtle point.
So the system must begin with some positive amount on both sides, and some positive number of shares outstanding on both sides.
In other words, the mechanism is a zero sum game, and the market institution takes no portion of the money.
How many shares?
(2) At this point we make a critical assumption in order to greatly simplify the analysis; we assume that E[P1|A] = P1.
Regardless of whether (3) is true, each price function derived below implies a  welldefined zero-sum game in which traders can play.
MPr(A) is the solution to 0 = MPr(A) · E[P1|A] − (1 − MPr(A)) · p1.
In this way, the market looks more  familiar to traders, like a typical CDA with a number of ask orders at various prices automatically available.
These initial amounts can be arbitrarily small in principle, but the size of the initial subsidy may affect the incentives of traders to participate.
Then ask orders of 100 shares each at the appropriate price can be automatically placed by the market institution.
(12) Note that, as required, p1(0) = M1/ √ N1N2, and p1(0)/p2(0) = M1/M2.
Also, the smaller the initial amounts, the more each new dollar effects the prices.
It"s not obvious, however, that the assumption is true well before the market"s close.
We can consider MPr(A) to be the aggregate probability of A as judged by the market as a whole.
(7) Note that p1(0) = M1/N2 = P2 as required.
On the other hand, the ability to easily infer an aggregate market consensus probability from market prices does depend on (3).
4.2 Price functions A variety of price functions seem reasonable, each  exhibiting various properties, and implying differing market  probabilities.
A more standard interface can be  implemented by discretizing the costs into round lots of shares, for example lots of 100 shares.
That is, p1 = P2 p2 = P1.
Also note that seed or ante wagers are required to initialize the system. 
So, the utility of DPM for hedging and speculating does not necessarily hinge on the truth of assumption (3).
The equations for B are symmetric.
(4) Enforcing this relationship reduces the dimensionality of the system from four to two, simplifying the interface: traders need only track two numbers instead of four.
175 That is, p1 p2 = M1 M2 .
Note that, as before, the mechanism can be modified to collect transaction fees of some kind.
We examine scenarios below in which 174 assumption (3) seems especially plausible.
Nonetheless, the assumption effects our analysis only.
