Lemma 15. ρbc + ρcb = 0 for all b, c ∈ A.
Now we are ready for the zero three-cycle property: Lemma 17. ρab + ρbc + ρca = 0 for all a, b, c ∈ A.
Since −→a is a straight (b, c)-path, ρbc = δ(−→a ) ≤ v(b) − v(c), leading to a contradiction.
Now for any b, c ∈ A and any (b, c)-path −→a with C(−→a ) = ∅, let −→u ∈ C(−→a ).
Moreover, by lemma 16, no (u, v, w) ∈ Rabc is collinear.
Let −→a be a straight (b, c)-path compatible with linear sequence −→u .
For (a, b, c) ∈ S, the restriction of f to the compact set Rabc attains a minimum m(a, b, c) at some point (u, v, w) ∈ Rabc by the continuity of f, i.e., there exists a triangle ∆uvw of minimum perimeter within T with u ∈ Da, v ∈ Db, w ∈ Dc.
, ak = c), by lemma 14, δ(−→a ) = k−1X i=1 δaiai+1 ≥ k−1X i=1 ρaiai+1 , which by theorem 18, = −ρaka1 = ρa1ak = ρbc.
To prove theorem 4, it suffices to show the zero cycle property of Gf , i.e.,  every directed cycle has weight zero.
By the convexity of domain D, there is d ∈ A such that p ∈ Dd.
Clearly (−→a , −→u ) ∈ LCuw ac and δ(−→a ) = k−1X i=1 δaiai+1 + δak a1 + l−1X i=1 δai ai+1 = δ(−→a ) + δbb + δ(−→a ) = δ(−→a ) + δ(−→a ).
Since each of them has perimeter less than that of ∆u∗ v∗ w∗ and all three triangles are contained in T, by the minimality of ∆u∗ v∗ w∗ , (a∗ , d, c∗ ), (c∗ , d, b∗ ), (b∗ , d, a∗ ) ∈ S. Thus ρa∗d + ρdc∗ + ρc∗a∗ = 0, ρc∗d + ρdb∗ + ρb∗c∗ = 0, ρb∗d + ρda∗ + ρa∗b∗ = 0.
Let |−→a | = ord(−→u ) = k and |−→a | = ord(−→u ) = l. We paste −→a and −→a together as −→a = (a = a1, a2, .
Lemma 14. ρbc ≤ δbc for all b, c ∈ A.
Obviously, path −→a = (b, c) is compatible with linear sequence −→u = (v, v, v) and is thus a straight (b, c)-path.
For any b, c ∈ A, ρbc is equal to δ∗ bc, the minimum δ-weight over all (b, c)-paths.
Obviously, (−→a , −→u ) is compatible as well and thus −→a is a straight (c, b)-path.
Since ui ∈ Dai ∩ Dai+1 for i ∈ [|−→a | − 1], δ(−→a ) = |−→a |−1 X i=1 δaiai+1 = |−→a |−1 X i=1 ρaiai+1 , which by theorem 18, = −ρa|−→a |a1 = ρa1a|−→a | = ρbc.
For each a ∈ A, choose va ∈ Da arbitrarily and let T be the convex hull of {va : a ∈ A}.
The case that u is between v and w is similar.
Choose (a∗ , b∗ , c∗ ) ∈ S so that m(a∗ , b∗ , c∗ ) is minimum and let (u∗ , v∗ , w∗ ) ∈ Ra∗b∗c∗ be a triple achieving it.
Now suppose w is between u and v. By the above  argument, we have ρac + ρcb + ρba = 0 and by lemma 15, ρab + ρbc + ρca = −ρba − ρcb − ρac = 0.
By lemma 8, there is a compatible pair (−→a , −→u ) ∈ LCvw bc with δ(−→a ) ≤ v(b) − v(c).
Immediately from lemma 14, the weight of every directed cycle in Gf is bounded below by its weight in Gf .
Therefore, ρac = δ(−→a ) = δ(−→a ) + δ(−→a ) = ρab + ρbc.
Moreover, ρac = −ρca by lemma 15, so we get ρab + ρbc + ρca = 0.
Therefore, ρbc + ρcb = δ(−→a ) + δ(−→a ) = k−1X i=1 δaiai+1 + k−1X i=1 δai+1ai = k−1X i=1 (δaiai+1 + δai+1ai ) = 0, where the final equality uses proposition 5.
For any b, c ∈ A, every admissible (b,  c)path has the same δ-weight ρbc.
First, we prove for the case where v is between u and w. From lemma 8, there are compatible pairs (−→a , −→u ) ∈ LCuv ab , (−→a , −→u ) ∈ LCvw bc .
Define f : D3 → R by f(u, v, w) = |v−u|+|w−v|+|u−w|.
To see this, pick v ∈ Db ∩ Dc arbitrarily.
For contradiction, suppose ρbc − δbc = > 0.
With the zero two-cycle and three-cycle properties, the zero cycle property of Gf is immediate.
By the definition of δbc, there exists v ∈ f−1 (b) ⊆ Db with v(b) − v(c) < δbc + = ρbc.
On the other hand, for every (b, c)-path −→a = (b = a1, a2, .
Hence ρbc = δ(−→a ) = δbc.
291 Consider triangles ∆u∗ pw∗ , ∆w∗ pv∗ and ∆v∗ pu∗ .
Define another edge-weighted complete directed graph Gf on vertex set A where the weight of arc (a, b) is ρab.
If there are collinear points u ∈ Da, v ∈ Db, w ∈ Dc (a, b, c ∈ A), ρab + ρbc + ρca = 0.
let −→a be the reverse of −→a and −→u the reverse of −→u .
Let S = {(a, b, c) : ρab + ρbc + ρca = 0} and for contradiction, suppose S = ∅.
As final remarks, we note that our result implies the  following strengthenings of theorem 12: Corollary 19.
For a directed cycle C = a1a2 .
Hence ρbc ≤ δ∗ bc, which completes the proof. 
For each (a, b, c) ∈ S, let Rabc = Da × Db × Dc ∩ T3 .
Clearly, zero two-cycle and three-cycle properties imply triangle equality ρab +ρbc = ρac for all a, b, c ∈ A.
Clearly ρbc ≥ δ∗ bc by corollary 13.
Pick an arbitrary point p in the interior of ∆u∗ v∗ w∗ .
Next, for three cycles, we first consider those compatible with linear triples.
First notice that for any b, c ∈ A, if Db ∩Dc = ∅, δbc = ρbc.
, al = c), −→u and −→u as −→u = (u = u0, u1, .
We begin by considering two-cycles.
Summing up the three equalities, (ρa∗d + ρdc∗ + ρc∗d + ρdb∗ + ρb∗d + ρda∗ ) +(ρc∗a∗ + ρb∗c∗ + ρa∗b∗ ) = 0, which yields a contradiction ρa∗b∗ + ρb∗c∗ + ρc∗a∗ = 0.
As noted earlier, this completes the proof of theorem 4.
aka1, by inductively applying triangle equality, we have Pk−1 i=1 ρaiai+1 = ρa1ak .
Therefore, the weight of C is k−1X i=1 ρaiai+1 + ρaka1 = ρa1ak + ρaka1 = 0.
Pick an arbitrary w ∈ Dc.
Every directed cycle of Gf has weight zero.
Corollary 20.
Lemma 16.
, ul = w).
, uk = v = u0 , u1 , .
S is finite.
Theorem 18.
Clearly, each Rabc is nonempty and compact.
, ak−1, ak, a1 , .
