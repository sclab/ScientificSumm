The Countermeasure_2 resource receives the alerts generated by analysers 3 and 2, in accordance with the implementation of its Native IDS component.
In addition to generating alerts in IDMEF format, Analyser_2 also directs the received data to the Analyser_3, in the level of complexity 2.
The resources carry out tasks such as data collection, aggregation and analysis, and generation of alerts and warnings in an integrated manner. 
The generated data is directed to Analyser_1 and Aggreg_Corr_1 resources, in the case of Sensor_1, and to Aggreg_Corr_1 in the case of Sensor_2, according to the specification of their descriptors.
The resultant information of the processing of Aggreg_Corr_1 was directed to the Analyser_2 resource.
The Native IDS component of the Analyser_2 generates alerts when a source tries to connect to the same port number of multiple destinations.
The data received from Analyser_1 had presented such features, generating an IDMEF (Intrusion Detection Message Exchange Format) alert [14].
Classes were developed to simulate the processing of each Native IDS components associated to the resources.
The resulting relationship between the resources integrated to the DIDSoG, in accordance with the specification of its respective descriptors, is presented in Figure 5.
The Simulation_DIDSoG class starts the simulation components.
User_1 Analyser_ 1 Level 1:1 Sensor_1 Aggreg_ Corr_1 Level 2:1 User_2 Sensor_2 Analyser_2 Level 2:1 Analyser_3 Level 2:2 TCPDump TCPDump TCPDumpAg TCPDumpAg IDMEF IDMEF IDMEF TCPDump  Countermeasure_1 Level 1  Countermeasure_2 Level 2 Fig.
This situation is identified by the Analyser_2 in the data received from Aggreg_Corr_1 and an alert in IDMEF format is then sent to the Countermeasures_2 resource.
The Native IDS component of Analyser_3 generates alerts when the transmission of ICMP messages from a given source to multiple destinations is detected.
Simulated data was generated to be the input for a grid of intrusion detection systems composed by several distinct resources.
A XML file describing each of the integrated resources is chosen by using the Connector component.
We have used and extended GridSim features to model and simulate the resources and components of DIDSoG.
The generated alert was sent to Countermeasure_1 resource, where a warning was dispatched to the administrator informing him of the alert received.
The Sensor_1 and Sensor_2 resources generate simulated data in the TCPDump [8] format.
This situation is detected in the data received from Analyser_2, and an IDMEF alert is then sent to the Countermeasure_2 resource.
For each simulated Native IDS a class derived from DIDSoG_BaseResource was developed.
This class" function is to initiate the processing of a resource Sensor, from where the gathered information will be sent to other resources.
This class corresponds to the Connector component of the Native IDS and aims at the integrating the IDS to DIDSoG.
Warnings on alerts received are dispatched to the administrator.
The Connector component is implemented by creating a class derived from DIDSoG_BaseResource.
In the simulation environment, data collection resources, analysis, aggregation/correlation and generation of answers were integrated.
Its processing activities consist in correlating the source IP addresses with the received data.
The new class will implement new functionalities in accordance with the needs of the corresponding Native IDS.
The Aggreg_Corr_1 resource received the information generated by sensors 1 and 2.
DIDSoG_GIS keeps a registry of the DIDSoG resources.The DIDSoG_BaseResource class implements the Base component (see Figure 2).
The Simulation_User class represents a user of DIDSoG.
The Native IDS of Analyser_1 generates alerts for any attempt of connection to port 23.
The DIDSoG_Descriptor class is created from an XML file that specifies a resource descriptor (see Figure 3).
Figure 4 presents the Class diagram of the simulated DIDSoG.
A Connector component must be developed for each Native IDS integrated to DIDSoG.
Flow of the execution of the simulation.
Class Diagram of the simulatated DIDSoG.
DIDSoG_BaseResource interacts with DIDSoG_Descriptor class, which represents the Descriptor component.
We have used GridSim Toolkit 3 [1] for development and evaluation of the proposed model.
The simulation carried out demonstrates how DIDSoG works.
DIDSoG_BaseResource DIDSoG_Descriptor 11 DIDSoG_GIS Simulation_User Simulation_DIDSoG 1 *1* 1 1 GridInformationService GridSim GridResource Fig.
