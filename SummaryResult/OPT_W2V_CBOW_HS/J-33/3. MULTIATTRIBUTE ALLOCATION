The Multiattribute Matching  Problem (MMP) is to find a best trade for a given pair of traders, MMP(b, s) = arg max t∈OT b ∩OT s σ(t).
Divisibility, linear pricing, and configuration parity  (Definitions 1, 10, and 9), with combination offer set defined as the minimal set consistent with configuration aggregation  (Definition 6).2 Then the solution to GMAP consists of a set of trades, each of which employs a configuration that solves MMP for its specified pair of traders.
Then the solution to GMAP consists of a set of trades, each of which is a solution to MMP for its specified pair of traders.
Suppose agents b and s exhibit configuration  parity, divisibility, and linear pricing, and there exists configuration x such that ˆub(x) − ˆus(x) > 0.
The surplus of trade t = (x, q, b, s, π) in the context of other trades T, σ(t; T), is given by ˆuB b (x, q; T) − ˆuS s (x, q; T).
Suppose all agents" offers exhibit no aggregation (Definition 4).
Let MMPd (b, s) denote a modified version of MMP, where OT b and OT s are extended to assume divisibility (i.e., the offer sets are taken to be their closures under Definition 1).
DEFINITION 14 (SURPLUS OF A TRADE IN CONTEXT).
Suppose offer sets as in Theorem 3, except that agents i satisfying configuration aggregation need be divisible only down to qi, rather than down to 0.
(1) The preceding results signify that under certain conditions, we can divide the global optimization problem into two parts: first find a bilateral trade that maximizes unit surplus for each pair of traders (or total surplus in the non-aggregation case), and then use the  results to find a globally optimal set of trades.
The surplus of trade t = (x, q, b, s, π) is given by σ(t) = ˆuB b (x, q) − ˆuS s (x, q).
THEOREM 2.
Under linear pricing, we can equivalently write σ1 (t) = ˆuB b (x) − ˆuS s (x).
No aggregation and configuration parity (Definitions 4 and 9).
Then we can extend Theorem 3 to allow aggregating agents to maintain AON or  minquantity offers as follows.
Suppose that each agent"s offer set satisfies one of the following (not necessarily the same) sets of conditions.
The Global Multiattribute  Allocation Problem (GMAP) is to find the set of acceptable trades  maximizing total surplus, max T ∈2T X t∈T σ(t; T \ {t}) s.t.
DEFINITION 12 (TRADE SURPLUS).
Note that the trade surplus does not depend on the payment, which is simply a transfer from buyer to seller.
The unit surplus of trade t = (x, q, b, s, π) is given by σ1 (t) = σ(t)/q.
Then t ∈ MMPd (b, s) iff xt = arg max x {ˆub(x) − ˆus(x)} qt = min(¯qb, ¯qs).
Then the solution to GMAP consists of a set of trades, each of which employs the same  configuration as a solution to MMPd for its specified pair of traders.
DEFINITION 13 (TRADE UNIT SURPLUS).
112 Proofs of all the following results are provided in an extended  version of this paper available from the authors.
If OT b ∩ OT s is empty, we say that MMP has no solution.
In the following two sections we investigate each of these subproblems. 
DEFINITION 15 (GMAP).
THEOREM 3.
Ti ∈ OC i .
THEOREM 5.
THEOREM 4.
DEFINITION 16 (MMP).
